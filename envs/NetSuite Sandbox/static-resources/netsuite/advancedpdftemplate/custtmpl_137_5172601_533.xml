<?xml version="1.0"?>
<!DOCTYPE pdf PUBLIC "-//big.faceless.org//report" "report-1.1.dtd">
<pdf>

    <head>
      <link name="NotoSans" type="font" subtype="truetype" src="${nsfont.NotoSans_Regular}" src-bold="${nsfont.NotoSans_Bold}" src-italic="${nsfont.NotoSans_Italic}" src-bolditalic="${nsfont.NotoSans_BoldItalic}" bytes="2" />
      <#if .locale=="zh_CN">
      <link name="NotoSansCJKsc" type="font" subtype="opentype" src="${nsfont.NotoSansCJKsc_Regular}" src-bold="${nsfont.NotoSansCJKsc_Bold}" bytes="2" />
      <#elseif .locale=="zh_TW">
      <link name="NotoSansCJKtc" type="font" subtype="opentype" src="${nsfont.NotoSansCJKtc_Regular}" src-bold="${nsfont.NotoSansCJKtc_Bold}" bytes="2" />
      <#elseif .locale=="ja_JP">
      <link name="NotoSansCJKjp" type="font" subtype="opentype" src="${nsfont.NotoSansCJKjp_Regular}" src-bold="${nsfont.NotoSansCJKjp_Bold}" bytes="2" />
      <#elseif .locale=="ko_KR">
      <link name="NotoSansCJKkr" type="font" subtype="opentype" src="${nsfont.NotoSansCJKkr_Regular}" src-bold="${nsfont.NotoSansCJKkr_Bold}" bytes="2" />
      <#elseif .locale=="th_TH">
      <link name="NotoSansThai" type="font" subtype="opentype" src="${nsfont.NotoSansThai_Regular}" src-bold="${nsfont.NotoSansThai_Bold}" bytes="2" />
      </#if>
	<macrolist>
      <macro id="nlheader">

<table line-height="100%" style="width: 100%;">
      <tr>
      <td valign="top" rowspan="11" width="50%" padding-left="0">
       <#if subsidiary.logo@url?has_content><img src="${subsidiary.logo@url}" style="float: left;"/></#if><br/><p valign="top" style="font-size:10px">
       <#if !(record.entity.printtransactions==true && (record.billingaddress.country=="Germany"||record.billingaddress.country=="Austria"))>
         <#if record.custbody_print_old_remittance?has_content> ${record.custbody_remittance_information.custrecord_old_remittance_address} <#else/>${subsidiary.mainaddress_text}</#if></#if></p></td>
      <td align="right" colspan="4" font-size="20px">&nbsp;</td>
      <td align="left" colspan="4" font-size="20px"><b><#if record.custbody_invoice_title_override?has_content> ${record.custbody_invoice_title_override} <#elseif record.custbody_invoice_label_translation?has_content> ${record.custbody_invoice_label_translation.custrecord_inv_label_invoice} <#else/> ${record.custbody_invoice_title}</#if></b></td>
	  </tr>
	  <tr>
      <td align="right" colspan="4"> <#if record.custbody_invoice_label_translation?has_content> ${record.custbody_invoice_label_translation.custrecord_inv_label_date} <#else/>Date</#if></td>
      <td align="left" colspan="4"> <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${record.trandate?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${record.trandate?string('dd-MMM-yyyy')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD.MM.YYYY'>${record.trandate?string('dd.MM.yyyy')}<#else/>${record.trandate?string('MMM-dd-yyyy')}</#if></td>
      </tr>
      <tr>
      <td align="right" colspan="4"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_invoice_num} <#else/>Invoice#</#if></td>
      <td align="left" colspan="4"><b><#if record.custbody_legacy_transaction_number?has_content> ${record.custbody_legacy_transaction_number} <#else/> ${subsidiary.id}-${record.tranid}</#if></b></td>
      </tr>
      <tr>
      <td align="right" colspan="4"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_po} <#else/>PO#</#if></td>
      <td align="left" colspan="4">${record.otherrefnum}</td>
      </tr>
	  <#if subsidiary.custrecord_print_order_type==true && record.custbody_so_ordertype?has_content>
      <tr>
      <td align="right" colspan="4"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_ordertype}<#else/>Order Type</#if></td>
        <td align="left" colspan="4"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_ordertype_translated} <#else/>${record.custbody_so_ordertype}</#if></td>
      </tr></#if>
      <tr>
      <td align="right" colspan="4">
        <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_duedate}<#else/>Due Date</#if></td>
      <td align="left" colspan="4">
        <#if record.duedate?has_content> <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${record.duedate?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${record.duedate?string('dd-MMM-yyyy')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD.MM.YYYY'>${record.duedate?string('dd.MM.yyyy')} <#else/> ${record.duedate?string('MMM-dd-yyyy')}</#if></#if></td>
      </tr>
      <tr>
      <td align="right" colspan="4" padding-top="5px">
       <#if record.subsidiary.taxidnum?has_content>
       <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_taxid}  
       <#elseif subsidiary.country='United States'>EIN# <#elseif subsidiary.country='Australia'> ABN <#elseif subsidiary.country='Ireland'>VAT No: IE 
        <#elseif subsidiary.country='United Kingdom'>VAT No: GB <#elseif subsidiary.country='Canada'> <#elseif subsidiary.country='Singapore'> GST# <#else/> VAT No </#if></#if></td>
      <td align="left" colspan="4" padding-top="5px"><#if subsidiary.country!='Canada'>${record.subsidiary.taxidnum}</#if></td>
      </tr>
      <#if subsidiary.country='Australia'>
      <tr>
      <td align="right" colspan="4"><#if subsidiary.state1taxnumber?has_content>ACN:</#if></td>
      <td align="left" colspan="4">${subsidiary.state1taxnumber}</td>
      </tr></#if>
	  <#if record.custbody_stripe_payment_method?has_content>
      <tr>
      <td align="right" colspan="4">
      <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_payment_method} <#else/>Payment Method</#if></td>
        <td align="left" colspan="4"><#if record.custbody_invoice_label_translation?has_content && record.custbody_payment_method_translated?has_content>${record.custbody_payment_method_translated} <#else/>${record.custbody_stripe_payment_method}</#if></td>
      </tr></#if>
      </table>
      </macro>

      <macro id="nlfooter">
      <table class="footer" style="width: 100%;">
		<#if record.shipcountry != subsidiary.country.internalid && record.custbody_in_eu==false && record.subsidiary.custrecord_footer_non_eu?has_content>
  		<tr>
  		<td align="center" padding-top="5px">${subsidiary.custrecord_footer_non_eu}</td>
  		</tr></#if>
        <#if record.shipcountry != subsidiary.country.internalid && record.custbody_in_eu==true && record.subsidiary.custrecord_footer_eu?has_content>
  		<tr>
  		<td align="center" padding-top="5px">${subsidiary.custrecord_footer_eu}</td>
  		</tr></#if> 
  		<#if record.subsidiary.custrecord_invoice_footer1?has_content>
  		<tr>
  		<td align="center" padding-top="5px">${subsidiary.custrecord_invoice_footer1}</td>
  		</tr></#if>
  		<#if record.subsidiary.custrecord_invoice_footer2?has_content>
  		<tr>
  		<td align="center" padding-top="5px">${subsidiary.custrecord_invoice_footer2}</td>
  		</tr></#if>
        <#if subsidiary.country.internalid=="GB" && record.shipcountry!="GB" >
        <tr>
        <td padding-top="5px" align="center"><p style="text-align: center; font-size: 7pt;">The supply is outside the scope of UK VAT in accordance with Section 7A (2) VAT Act 1994. It is the responsibility of the client to account for and pay VAT due</p></td>
        </tr></#if>
      <tr>
      <td align="right" padding-top="5px"><pagenumber /> of <totalpages /></td>
      </tr>
      </table>
      </macro>
      </macrolist>

      <style type="text/css">
        * {
          <#if .locale=="zh_CN">font-family: NotoSans, NotoSansCJKsc, sans-serif;
          <#elseif .locale=="zh_TW">font-family: NotoSans, NotoSansCJKtc, sans-serif;
          <#elseif .locale=="ja_JP">font-family: NotoSans, NotoSansCJKjp, sans-serif;
          <#elseif .locale=="ko_KR">font-family: NotoSans, NotoSansCJKkr, sans-serif;
          <#elseif .locale=="th_TH">font-family: NotoSans, NotoSansThai, sans-serif;
          <#else>font-family: NotoSans, sans-serif;
          </#if>
        }

        table {
          font-size: 9pt;
          table-layout: fixed;
        }

        th {
          font-weight: bold;
          font-size: 8pt;
          vertical-align: middle;
          padding: 5px 6px 3px;
          background-color: #e3e3e3;
          color: #333333;
        }

        td {
          padding: 4px 6px;
        }

        td p {
          text-align: left
        }

        b {
          font-weight: bold;
          color: #333333;
        }

        table.header td {
          padding: 0px;
          font-size: 10px;
        }

        table.footer td {
          padding: 0px;
          font-size: 8pt;
        }

        table.itemtable th {
          padding-bottom: 10px;
          padding-top: 10px;
          font-size: 9px;
        }

        table.body td {
          padding-top: 2px;
        }

        table.total {
          page-break-inside: avoid;
        }

        tr.totalrow {
          background-color: #e3e3e3;
          line-height: 200%;
        }

        td.totalboxtop {
          font-size: 12pt;
          background-color: #e3e3e3;
        }

        td.addressheader {
          font-size: 8pt;
          padding-top: 6px;
          padding-bottom: 2px;
        }

        td.address {
          padding-top: 0px;
          padding-left: 0px;
        }

        td.totalboxmid {
          font-size: 28pt;
          padding-top: 20px;
          background-color: #e3e3e3;
        }

        td.totalboxbot {
          background-color: #e3e3e3;
          font-weight: bold;
        }

        span.title {
          font-size: 28pt;
        }

        span.number {
          font-size: 16pt;
        }

        span.itemname {
          font-weight: bold;
          line-height: 150%;
        }

        hr {
          width: 100%;
          color: #d3d3d3;
          background-color: #d3d3d3;
          height: 1px;
        }
      </style>
    </head>

		<body header="nlheader" header-height="17%" footer="nlfooter" footer-height=<#if subsidiary.custrecord_invoice_footer1?length gt 0 && subsidiary.custrecord_invoice_footer2?length gt 0>"120px"<#else/>"72px"</#if> <#if record.billingaddress.country= 'Germany'|| record.billingaddress.country='Austria'> size="A4"<#else/> size="Letter"</#if> padding="0.25in 0.35in .25in 0.35in">



<table style="width: 100%; margin-top: 10px;">

  <#if (record.entity.printtransactions==true && (record.billingaddress.country=="Germany"||record.billingaddress.country=="Austria"))>
          <tr>
  		  <td class="address" colspan="4"  padding-bottom="20px" padding-left="50px" >
            ${subsidiary.name}
			${subsidiary.addr1} ${subsidiary.addr2}
 			${subsidiary.city}
            ${subsidiary.state} ${subsidiary.zip}
            ${subsidiary.country}
            </td>
  		  <td class="address" colspan="2"  padding-bottom="20px" style="padding-left:50px">
          </td></tr></#if>
        <tr >
        <td class="address" colspan="3" style="<#if (record.entity.printtransactions==true && (record.billingaddress.country=="Germany"||record.billingaddress.country=="Austria"))> padding-left:48px <#else/> padding-left:-2px</#if>"><b>
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_billaddress}<#else>Bill To</#if>:</b></td>
        <td class="address" colspan="3" style="padding-left:46px"><b>
          <#if record.subsidiary.custrecord_print_shipto_address==true><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_shipaddress}<#else/>Ship To</#if>:</#if></b></td>
        </tr>


        <tr>
		<td class="address" colspan="3" style="<#if (record.entity.printtransactions==true && (record.billcountry=="DE"|| record.billcountry=="AT"))> padding-left:50px</#if>">
			<#if record.custbody_bill_to_address_override?has_content>${record.custbody_bill_to_address_override}&nbsp;
            <#else/>
			<#if record.billaddressee?has_content>${record.billaddressee}<br/><#else>${record.entity.companyname}<br/></#if>
            <#if record.billattention?has_content>${record.billattention}<br/></#if>
            <#if record.billaddr1?has_content>${record.billaddr1}<br/></#if>
            <#if record.billaddr2?has_content>${record.billaddr2}<br/></#if>
            <#if record.billaddr3?has_content>${record.billaddr3}<br/></#if>
              <#if record.billcountry=='DE' || record.billcountry=='AT'>
                <#if record.billzip?has_content>${record.billzip}</#if> <#if record.billcity?has_content>${record.billcity}<br/></#if>
                <#if record.billstate?has_content>${record.billstate}<br/></#if> 
                <#else/>
                <#if record.billcity?has_content>${record.billcity} </#if><#if record.billstate?has_content>${record.billstate} </#if> 
                <#if record.billzip?has_content>${record.billzip}<br/></#if></#if>
                <#if subsidiary.custrecord_subsidiary_group='IDL Group' && record.billcountry=='DE' >Deutschland <#elseif subsidiary.custrecord_subsidiary_group='IDL Group' && record.billcountry=='AT'>Österreich <#else>${record.billingaddress.country}&nbsp;</#if>
            </#if>

              <#if record.entity.vatregnumber?has_content> <br /> <br /> <b><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_taxid} 
              <#elseif record.billcountry=='US'>EIN#: <#elseif record.billcountry=='AU'>ABN:  <#elseif record.billcountry=='NZ'>ABN: <#elseif record.billcountry=='CA'>TAX ID: <#else/>VAT: </#if></b>${record.entity.vatregnumber}</#if></td>

        <td class="address" colspan="3" style="padding-left:48px">
        <#if record.subsidiary.custrecord_print_shipto_address==true>
			<#if record.shipaddressee?has_content>${record.shipaddressee}<br/><#else>${record.entity.companyname}<br/></#if>
            <#if record.shipattention?has_content>${record.shipattention}<br/></#if>
            <#if record.shipaddr1?has_content>${record.shipaddr1}<br/></#if>
            <#if record.shipaddr2?has_content>${record.shipaddr2}<br/></#if>
            <#if record.shipaddr3?has_content>${record.shipaddr3}<br/></#if>
              <#if record.shipcountry=='DE' || record.shipcountry=='AT'>
                <#if record.shipzip?has_content>${record.shipzip}</#if> <#if record.shipcity?has_content>${record.shipcity}<br/></#if>
                <#if record.shipstate?has_content>${record.shipstate}<br/></#if> 
                <#else/>
                <#if record.shipcity?has_content>${record.shipcity} </#if><#if record.shipstate?has_content>${record.shipstate} </#if> 
                <#if record.shipzip?has_content>${record.shipzip}<br/></#if></#if>
                <#if subsidiary.custrecord_subsidiary_group='IDL Group' && record.shipcountry=='DE' >Deutschland <#elseif subsidiary.custrecord_subsidiary_group='IDL Group' && record.shipcountry=='AT'>Österreich <#else>${record.shippingaddress.country}&nbsp;</#if>
          </#if></td>
        </tr>
        <tr>
        </tr>
        <tr>
        <td class="address" colspan="3">&nbsp;</td>
        <td class="address" colspan="3">&nbsp;</td>
        </tr>
  	
  		<#if record.custbody_so_enduser?length gt 0 || record.custbody_invoice_contact?length gt 0 >
	  	<tr>
        <td class="address" colspan="3" padding-top="10"><#if record.custbody_so_enduser?length gt 0><b><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_enduser}<#else>End User</#if>:</b></#if></td>
        <td class="address" colspan="3" padding-top="10" padding-left=".5in"><#if record.custbody_invoice_contact?length gt 0><b><#if record.custbody_invoice_label_translation?has_content> ${record.custbody_invoice_label_translation.custrecord_inv_label_invoice_contact}<#else>Contact</#if>:</b></#if></td>
          </tr></#if>
        <tr>
        <td class="address" colspan="3" >${record.custbody_so_enduser.altname}</td>
        <td class="address" colspan="3" style="padding-left:48px"> ${record.custbody_invoice_contact.firstname}&nbsp;${record.custbody_invoice_contact.middlename}&nbsp;${record.custbody_invoice_contact.lastname}</td>
        </tr>
        <#if record.custbody_distributor == record.entity>
        <tr>
        <td class="address" colspan="3" padding-top="10"><b><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_partner_jv_reseller}<#else/>Partner/JV/Reseller</#if>:</b></td>
        <td class="address" colspan="3">&nbsp;</td>
        </tr>
        <tr>
        <td class="address" colspan="3">${record.custbody_partnerjvreseller.altname}</td>
        <td class="address" colspan="3">&nbsp;</td>
        </tr></#if>
        </table>


<#if subsidiary.custrecord_invoice_message?length gt 0 || record.message?has_content || record.custbody_invoice_message?has_content>
<table style="width: 100%; margin-top: 10px;">
        <tr>
          <td class="address"><b><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_message}<#else/>Invoice Message:</#if></b></td>
		</tr>
        <tr>
          <td class="address">
            <#if subsidiary.custrecord_invoice_message?length gt 1>${subsidiary.custrecord_invoice_message}</#if>
            <#if record.custbody_reversed_charge ==true && subsidiary.custrecord_reverse_charge_message2?length gt 1> ${subsidiary.custrecord_reverse_charge_message2}</#if>
            <#if record.message?length gt 1><br/>${record.message}</#if>
            <#if record.custbody_invoice_message?length gt 1><br/>${record.custbody_invoice_message}</#if></td>
  		</tr>
      </table></#if>

          
          
<#-- PRINT ITEM HEADER FIELDS -->
<#if record.item?has_content>
  <table border="1" class="itemtable" style="width: 100%; margin-top: 10px;">
  <!-- start items -->
        <#list record.item as item>
        <#if item_index==0>
        <thead>
        <tr border-bottom="1">
        <th align="left" border-color="#bdc3c7" border-right="1" colspan="3">
          <#if record.custbody_invoice_label_translation?has_content> ${record.custbody_invoice_label_translation.custrecord_inv_label_item}<#else/>Item</#if></th>
        <th border-color="#bdc3c7" border-right="1" colspan="6">
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_description}<#else/>Description</#if></th>
        <#if record.subsidiary.custrecord_print_erp_epm==true>
        <th align="center" border-color="#bdc3c7" border-right="1" colspan="3"><p>
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_erp_epm}<#else/>ERP/EPM</#if></p></th></#if>
        <th align="center" border-color="#bdc3c7" border-right="1" colspan="2" style="white-space: nowrap;">
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_quantity}<#else/>Quantity</#if></th>
        <#if record.subsidiary.custrecord_print_unit_price==true>
        <th align="center" border-color="#bdc3c7" border-right="1" colspan="3">
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_unit_price}<#else/>Unit Price</#if></th></#if>
        <#if subsidiary.custrecord_print_discount_gross_amount==true && record.custbody_print_discount=='T'>
        <th align="center" border-color="#bdc3c7" border-right="1" colspan="3"><span style="nowrap;">
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_gross_amount}<#else/>Gross<br/>Amount</#if></span></th>
        <th align="center" border-color="#bdc3c7" border-right="1" colspan="2">
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_discount}<#else/>Discount</#if></th></#if>
        <th align="right" border-color="#bdc3c7" border-right="1" colspan="3"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_amount}<#else/>Amount</#if></th>
        <#if record.subsidiary.custrecord_print_tax_column==true>
        <th align="right" border-color="#bdc3c7" border-right="1" colspan="2">
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_tax}<#else/>Tax</#if></th></#if>
        </tr>
        </thead>
        </#if>

          
          
<#-- PRINT ITEM BUNDLE -->          
<#if item.custcol_total_by_bundle!=0>
		<tr>
        <td align="left" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_bundle_name}</td>
        <td border-right="1" colspan="6" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_bundle_description}
        <#if item.custcol_term_start_date?has_content><br />
          <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_start_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_start_date?string('dd-MMM-yyyy')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD.MM.YYYY'>${item.custcol_term_start_date?string('dd.MM.yyyy')} <#else/>${item.custcol_term_start_date?string('MMM-dd-yyyy')}</#if></#if>
        <#if item.custcol_term_end_date?has_content> to <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_end_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_end_date?string('dd-MMM-yyyy')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD.MM.YYYY'>${item.custcol_term_end_date?string('dd.MM.yyyy')} <#else/>${item.custcol_term_end_date?string('MMM-dd-yyyy')}</#if></#if></td>
        <#if record.subsidiary.custrecord_print_erp_epm==true>
        <td align="center" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.class}</td></#if>
        <td align="right"  padding-right="20px" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_print_qty?string.number}</td>
        <#if record.subsidiary.custrecord_print_unit_price==true>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
        <#setting number_format=",##0.00">${item.custcol_total_by_bundle}</td></#if>
        <#if subsidiary.custrecord_print_discount_gross_amount==true && record.custbody_print_discount=='T'>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"> <#setting number_format=",##0.00"></td>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"></td></#if>
		<td align="right" colspan="3" line-height="150%" style="border-bottom:1; border-right:1; border-color: #bdc3c7;"><#setting number_format=",##0.00">${item.custcol_total_by_bundle}</td>
		<#if record.subsidiary.custrecord_print_tax_column==true>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"><#if record.subsidiary.country ='United States' || record.subsidiary.country ='Canada'><#setting number_format=",##0.00"><#elseif record.subsidiary.country ='Switzerland'><#setting number_format=",##0.0"> <#elseif record.subsidiary.country ='Schweiz'><#setting number_format=",##0.0"> <#else><#setting number_format=",##0"></#if> <#if item.taxrate2?length gt 0>${(item.taxrate1 + item.taxrate2) * 100}%<#else/>${item.taxrate1 *100}%</#if></td></#if>  
		</tr>

            
            

<#-- PRINT SYNTEC BUNDLE -->          
<#elseif item.custcol_syntec_total_by_bundle !=0>
		<tr>
        <td align="left" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.item}</td>
        <td border-right="1" colspan="6" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.description}
        <#if item.custcol_term_start_date?has_content><br />
          <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_start_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_start_date?string('dd-MMM-yyyy')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD.MM.YYYY'>${item.custcol_term_start_date?string('dd.MM.yyyy')}<#else/>${item.custcol_term_start_date?string('MMM-dd-yyyy')}</#if></#if>
        <#if item.custcol_term_end_date?has_content> to <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_end_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_end_date?string('dd-MMM-yyyy')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD.MM.YYYY'>${item.custcol_term_end_date?string('dd.MM.yyyy')} <#else/>${item.custcol_term_end_date?string('MMM-dd-yyyy')}</#if></#if></td>
        <#if record.subsidiary.custrecord_print_erp_epm==true>
        <td align="center" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.class}</td></#if>
        <td align="right"  padding-right="20px" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_print_qty?string.number}</td>
        <#if record.subsidiary.custrecord_print_unit_price==true>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
        <#setting number_format=",##0.00">${item.custcol_syntec_total_by_bundle}</td></#if>
        <#if subsidiary.custrecord_print_discount_gross_amount==true && record.custbody_print_discount=='T'>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"> <#setting number_format=",##0.00"></td>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"></td></#if>
		<td align="right" colspan="3" line-height="150%" style="border-bottom:1; border-right:1; border-color: #bdc3c7;"><#setting number_format=",##0.00">${item.custcol_syntec_total_by_bundle}</td>
		<#if record.subsidiary.custrecord_print_tax_column==true>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"><#if record.subsidiary.country ='United States' || record.subsidiary.country ='Canada'><#setting number_format=",##0.00"><#elseif record.subsidiary.country ='Switzerland'><#setting number_format=",##0.0"> <#elseif record.subsidiary.country ='Schweiz'><#setting number_format=",##0.0"> <#else><#setting number_format=",##0"></#if> <#if item.taxrate2?length gt 0>${(item.taxrate1 + item.taxrate2) * 100}%<#else/>${item.taxrate1 *100}%</#if></td></#if>  
		</tr>

            
            

<#-- PRINT RECURRING SUBCRIPTIONS IN GROUP>
<#-- Print items grouped by Recurring Subscription (On-Prem Term License) Revenue and SaaS Revenue and if Order type is renewal, or if item is a commission item. See the custom field Print Description -->
<#elseif  item.custcol_group_renewal_licenses='Y' && item.custcol_print_amount_grouped_yn='Y'>
		<tr>
        <td align="left" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"> 
          <#if item.custcol_item_name_translated?has_content> ${item.custcol_item_name_translated}<#else/>${item.custcol_print_item}</#if></td>
        <td border-right="1" colspan="6" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_print_description}
		  <#if item.custcol_term_start_date?has_content><br />
          <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_start_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_start_date?string('dd-MMM-yyyy')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD.MM.YYYY'>${item.custcol_term_start_date?string('dd.MM.yyyy')} <#else/>${item.custcol_term_start_date?string('MMM-dd-yyyy')}</#if></#if>
        <#if item.custcol_term_end_date?has_content> to <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_end_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_end_date?string('dd-MMM-yyyy')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD.MM.YYYY'>${item.custcol_term_end_date?string('dd.MM.yyyy')} <#else/>${item.custcol_term_end_date?string('MMM-dd-yyyy')}</#if></#if></td>
        <#if record.subsidiary.custrecord_print_erp_epm==true>  
        <td align="center" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_print_erp_epm}</td></#if>
        <td align="right" padding-right="20px" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_print_qty?string.number}</td>
        <#if record.subsidiary.custrecord_print_unit_price==true>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
          <#setting number_format=",##0.00">${item.custcol_print_item_rate}</td></#if>
        <#if subsidiary.custrecord_print_discount_gross_amount==true && record.custbody_print_discount=='T'>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"><#setting number_format=",##0.00">${item.custcol_print_gross_unit_price}</td>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_discount_precent?string.percent}</td></#if>
        <td align="right" colspan="3" line-height="150%" style="border-bottom:1; border-right:1; border-color: #bdc3c7;"><#setting number_format=",##0.00">${item.custcol_print_amount}</td>
        <#if record.subsidiary.custrecord_print_tax_column==true>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"><#if record.subsidiary.country ='United States' || record.subsidiary.country ='Canada'><#setting number_format=",##0.00"><#elseif record.subsidiary.country ='Switzerland'><#setting number_format=",##0.0"> <#elseif record.subsidiary.country ='Schweiz'><#setting number_format=",##0.0"> <#else><#setting number_format=",##0"></#if> <#if item.taxrate2?length gt 0>${(item.taxrate1 + item.taxrate2) * 100}%<#else/>${item.taxrate1 *100}%</#if></td></#if>
        </tr>

            
            
<#-- PRINT OTHER ITEMS IN DETAILS -->
<#elseif (item.custcol_print_time_entry==false && item.custcol_print_milestone_item==false && item.custcol_billable_expense==false) && (item.custcol_group_renewal_licenses ='N') && (item.custcol_bundle_name='')>
		<tr>
        <td align="left" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
        <#if record.subsidiary.custrecord_print_product_code==true && item.custcol_item_display_name?has_content>${item.custcol_item_display_name} <#elseif item.custcol_item_name_translated?has_content> ${item.custcol_item_name_translated}<#else/>${item.item}</#if></td>
        <td border-right="1" colspan="6" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.description}
        <#if item.custcol_term_start_date?has_content><br />
          <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_start_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_start_date?string('dd-MMM-yyyy')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD.MM.YYYY'>${item.custcol_term_start_date?string('dd.MM.yyyy')} <#else/>${item.custcol_term_start_date?string('MMM-dd-yyyy')}</#if></#if>
        <#if item.custcol_term_end_date?has_content> to <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_end_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_end_date?string('dd-MMM-yyyy')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD.MM.YYYY'>${item.custcol_term_end_date?string('dd.MM.yyyy')} <#else/>${item.custcol_term_end_date?string('MMM-dd-yyyy')}</#if></#if></td>
        <#if record.subsidiary.custrecord_print_erp_epm==true>
        <td align="center" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.class}</td></#if>
        <td align="right"  padding-right="20px" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_print_qty?string.number}</td>
        <#if record.subsidiary.custrecord_print_unit_price==true>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
        <#setting number_format=",##0.00">${item.custcol_gross_unit_price/item.quantity}</td></#if>
        <#if subsidiary.custrecord_print_discount_gross_amount==true && record.custbody_print_discount=='T'>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"> <#setting number_format=",##0.00">${item.custcol_gross_unit_price}</td>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_discount_precent?string.percent}</td></#if>
		<td align="right" colspan="3" line-height="150%" style="border-bottom:1; border-right:1; border-color: #bdc3c7;"><#setting number_format=",##0.00">${item.amount}</td>
		<#if record.subsidiary.custrecord_print_tax_column==true>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"><#if record.subsidiary.country ='United States' || record.subsidiary.country ='Canada'><#setting number_format=",##0.00"><#elseif record.subsidiary.country ='Switzerland'><#setting number_format=",##0.0"> <#elseif record.subsidiary.country ='Schweiz'><#setting number_format=",##0.0"> <#else><#setting number_format=",##0"></#if> <#if item.taxrate2?length gt 0>${(item.taxrate1 + item.taxrate2) * 100}%<#else/>${item.taxrate1 *100}%</#if></td></#if>  
          </tr>

            
            
<#-- PRINT MILESTONE ITEMS (ACTUAL CHARGES) -->
<#elseif item.custcol_print_milestone_item==true && item.item !="OpenAir Integration">
		<tr>
        <td align="left" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
          <#if item.custcol_item_name_translated?has_content> ${item.custcol_item_name_translated}<#else/>${item.custcol_print_item}</#if></td>
        <td border-right="1" colspan="6" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_print_description}
		<#if item.custcol_term_start_date?has_content><br /> <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_start_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_start_date?string('dd-MMM-yyyy')}  <#elseif record.subsidiary.custrecord_pdf_date_format='DD.MM.YYYY'>${item.custcol_term_start_date?string('dd.MM.yyyy')} <#else/>${item.custcol_term_start_date?string('MMM-dd-yyyy')}</#if></#if>
          <#if item.custcol_term_end_date?has_content> to <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_end_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_end_date?string('dd-MMM-yyyy')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD.MM.YYYY'>${item.custcol_term_end_date?string('dd.MM.yyyy')} <#else/>${item.custcol_term_end_date?string('MMM-dd-yyyy')}</#if></#if> </td>
        <#if record.subsidiary.custrecord_print_erp_epm==true>  
        <td align="center" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_print_erp_epm}</td></#if>
        <td align="right" padding-right="20px" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_print_qty?string.number}</td>
        <#if record.subsidiary.custrecord_print_unit_price==true>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
          <#setting number_format=",##0.00">${item.custcol_print_item_rate}</td></#if>
        <#if subsidiary.custrecord_print_discount_gross_amount==true && record.custbody_print_discount=='T'>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_print_gross_unit_price}</td>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_discount_precent?string.percent}</td></#if>
        <td align="right" colspan="3" line-height="150%" style="border-bottom:1; border-right:1; border-color: #bdc3c7;"><#setting number_format=",##0.00">${item.amount}</td>
        <#if record.subsidiary.custrecord_print_tax_column==true>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"><#if record.subsidiary.country ='United States' || record.subsidiary.country ='Canada'><#setting number_format=",##0.00"><#elseif record.subsidiary.country ='Switzerland'><#setting number_format=",##0.0"> <#elseif record.subsidiary.country ='Schweiz'><#setting number_format=",##0.0"> <#else><#setting number_format=",##0"></#if> <#if item.taxrate2?length gt 0>${(item.taxrate1 + item.taxrate2) * 100}%<#else/>${item.taxrate1 *100}%</#if></td></#if>  
        </tr>

          
          
<#-- PRINT TIME ENTRIES (ACTUAL CHARGES) -->
<#elseif item.custcol_print_total_qty_byitem?has_content && item.custcol_print_time_entry==true && item.item !="OpenAir Integration">
        <tr>
        <td align="left" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
          <#if item.custcol_item_name_translated?has_content> ${item.custcol_item_name_translated}<#else/>${item.custcol_print_item}</#if></td>
        <td border-right="1" colspan="6" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_print_description}</td>
        <#if record.subsidiary.custrecord_print_erp_epm==true>
        <td align="center" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_print_erp_epm}</td></#if>
        <td align="right" padding-right="20px" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_print_total_qty_byitem?string.number}</td>
        <#if record.subsidiary.custrecord_print_unit_price==true>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
          <#setting number_format=",##0.00">
            <#if item.custcol_print_total_qty_byitem!=0 && item.custcol_total_amount_by_item?has_content && item.custcol_total_amount_by_item!=0>${item.custcol_total_amount_by_item/item.custcol_print_total_qty_byitem}
              <#else/>${record.subtotal / item.custcol_print_total_qty_byitem}</#if></td></#if>
        <td align="right" colspan="3" line-height="150%" style="border-bottom:1; border-right:1; border-color: #bdc3c7;">
          <#if item.custcol_total_amount_by_item?has_content> <#setting number_format=",##0.00">${item.custcol_total_amount_by_item} 
            <#else/>${record.subtotal}</#if></td>
		<#if record.subsidiary.custrecord_print_tax_column==true>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"><#if record.subsidiary.country ='United States' || record.subsidiary.country ='Canada'><#setting number_format=",##0.00"><#elseif record.subsidiary.country ='Switzerland'><#setting number_format=",##0.0"> <#elseif record.subsidiary.country ='Schweiz'><#setting number_format=",##0.0"> <#else><#setting number_format=",##0"></#if> <#if item.custcol_total_tax_by_item !=0> ${(item.custcol_total_tax_by_item / item.custcol_total_amount_by_item) * 100}% <#elseif item.taxrate2?length gt 0>${(item.taxrate1 + item.taxrate2) * 100}%<#else/>${item.taxrate1 *100}%</#if></td></#if>  
        </tr>

          
          
<#-- PRINT TOTAL BILLABLE EXPENSES -->
<#elseif item.custcol_total_amount_by_item?has_content && item.custcol_total_amount_by_item!=0 && item.custcol_billable_expense==true>
        <tr>
        <td align="left" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
          <#if item.custcol_item_name_translated?has_content> ${item.custcol_item_name_translated}<#else/>${item.custcol_print_item}</#if></td>
          <td border-right="1" colspan="6" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"> <#if  record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_total_billable_exp}<#else/>Total Billable Expenses </#if></td>
        <#if record.subsidiary.custrecord_print_erp_epm==true>
        <td align="center" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_print_erp_epm}</td></#if>
        <td align="right" padding-right="20px" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_print_total_qty_byitem?string.number}</td>
        <#if record.subsidiary.custrecord_print_unit_price==true>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
          <#setting number_format=",##0.00">
            <#if item.custcol_print_total_qty_byitem!=0 && item.custcol_total_amount_by_item?has_content && item.custcol_total_amount_by_item!=0></#if></td></#if>
        <td align="right" colspan="3" line-height="150%" style="border-bottom:1; border-right:1; border-color: #bdc3c7;">
          <#if item.custcol_total_amount_by_item?has_content> <#setting number_format=",##0.00">${item.custcol_total_amount_by_item} 
            <#else/>${record.subtotal}</#if></td>
		<#if record.subsidiary.custrecord_print_tax_column==true>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"><#if record.subsidiary.country ='United States' || record.subsidiary.country ='Canada'><#setting number_format=",##0.00"><#elseif record.subsidiary.country ='Switzerland'><#setting number_format=",##0.0"> <#elseif record.subsidiary.country ='Schweiz'><#setting number_format=",##0.0"> <#else><#setting number_format=",##0"></#if> <#if item.taxrate2?length gt 0>${(item.taxrate1 + item.taxrate2) * 100}%<#else/>${item.taxrate1 *100}%</#if></td></#if>  
        </tr>


  </#if>
        </#list>
        </table>
        </#if>
          
          
<#-- ADDITIONAL TABLE TO SHOW DETAILS OR ADDITIONAL INFORMATION -->          
<#-- PRINT MILESTONE DETAILS -->
<#if record.item?has_content && record.custbody_print_milestone=='T'>
		<p font-size="10px"><b><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_fixed_fee_details}
          <#else/>Fixed Fee Details</#if></b>
        </p>
<table border="1" style="width: 100%; margin-top: 10px;">
		<!-- start items -->
        <#list record.item as item>
        <#if item_index==0>
        <thead>
        <tr border-bottom="1">
        <th colspan="3"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_date}<#else/>Date</#if></th>
        <th colspan="16"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_Description}<#else/>Description</#if></th>
        <th colspan="3" align="right"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_amount}<#else/>Amount</#if></th>
        </tr>
        </thead>
        </#if>
<#if item.custcol_print_milestone_item==true>
		<tr>
        <td colspan="3">${item.custcol_oa_date}</td>
        <td colspan="16">${item.description}</td>
		<#setting number_format=",##0.00">
        <td colspan="3" align="right">${item.custcol_unit_price}</td>
        </tr></#if>
        </#list>
  		</table>
  		</#if>

              
              
<#-- PRINT SERVICE ITEMS IN DETAILS -->
<#if record.item?has_content && ((record.custbody_print_time_entry=='T' && record.custbody_expand_service_items==true) || (record.custbody_print_time_entry=='T' && subsidiary.custrecord_expand_service_items_invoice==true))>
		<p font-size="10px"><b><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_service_details} <#else/>SERVICE DETAILS</#if></b>
		</p>
<table border="1" style="width: 100%; margin-top: 10px;">
		<!-- start items -->
        <#list record.item as item>
        <#if item_index==0>
        <thead>
        <tr border-bottom="1">
        <th colspan="3"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_date}<#else/>Date</#if></th>
		<th colspan="4"><span style="nowrap;"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_name}<#else/>Name</#if></span></th>
        <th colspan="9"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_task_note}<#else/>Task/Note</#if></th>
        <th colspan="2" align="right" padding-right="10" ><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_units}<#else/>Units</#if></th>
        <th colspan="3" align="right"><#if record.custbody_invoice_label_translation?has_content> ${record.currency}${record.custbody_invoice_label_translation.custrecord_inv_label_rate}<#else/>Rate</#if></th>
        <th colspan="3" align="right"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_amount}<#else/>Amount</#if></th>
        </tr>
        </thead>
        </#if>
<#if item.custcol_print_time_entry==true && item.custcol_billable_expense==false>
		<tr>
        <td colspan="3">${item.custcol_oa_date}</td>
    	<td colspan="4">${item.custcol_oa_wbs_assignees}</td>
        <td colspan="9">${item.custcol_oa_wbs_task_name}: ${item.description} <#if item.custcol_oa_client_notes?has_content> : ${item.custcol_oa_client_notes} </#if></td>
        <#setting number_format=",##0.00">
		<td colspan="2" align="right" padding-right="10">${item.custcol_quantity_for_customer}</td>
        <#setting number_format=",##0.00">
        <td colspan="3" align="right">${item.custcol_unit_price}</td>
		<#setting number_format=",##0.00">
        <td colspan="3" align="right">${item.custcol_print_qty*item.custcol_unit_price}</td>  
        </tr></#if>
  		</#list>
        </table>
  		</#if>

              
              
<#-- PRINT SERVICES GROUPED BY EMPLOYEE AND TASKS -->
<#if record.item?has_content && record.custbody_print_time_entry=='T' && record.custbody_expand_service_items!=true && subsidiary.custrecord_expand_service_items_invoice!=true>
		<p font-size="10px"><b><#if  record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_services} <#else/> SERVICES </#if></b>
  		</p>
<table border="1" style="width: 100%; margin-top: 10px;">
		<!-- start items -->
        <#list record.item?sort_by("custcol_oa_wbs_task_name","custcol_oa_wbs_assignees") as item>
        <#if item_index==0>
        <thead>
        <tr border-bottom="1">
		<th colspan="4"> <span style="nowrap;"><span style="nowrap;">
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_name}<#else/>Name</#if></span></span></th>
        <th colspan="9"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_task_note}<#else/>Task</#if></th>
        <th colspan="2" align="right" padding-right="10" ><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_units}<#else/>Units</#if></th>
        <th colspan="3" align="right" ><#if record.custbody_invoice_label_translation?has_content>${record.currency} ${record.custbody_invoice_label_translation.custrecord_inv_label_rate}<#else/>Rate</#if></th>
        <th colspan="3" align="right"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_amount}<#else/>Amount</#if></th>
        </tr>
        </thead>
        </#if>
<#if item.custcol_print_time_entry==true && item.custcol_print_total_hours_bytask_byem?has_content && item.custcol_billable_expense==false>
		<tr>
    	<td colspan="4">${item.custcol_oa_wbs_assignees}</td>
        <td colspan="9">${item.custcol_oa_wbs_task_name}</td>
		<td colspan="2" align="right" padding-right="10">${item.custcol_print_total_hours_bytask_byem?string.number}</td>
   		<#setting number_format=",##0.00">
        <td colspan="3" align="right">${item.custcol_unit_price}</td>
        <#setting number_format=",##0.00">
        <td colspan="3" align="right">${item.custcol_print_total_hours_bytask_byem*item.custcol_unit_price}</td>
        </tr></#if>
  		</#list>
        </table>
  		</#if>

              
              
<#-- PRINT BILLABLE EXPENSE DETAILS -->
<#if record.custbody_has_billable_expense=='T'>
  <p font-size="10px"><b><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_billable_expenses} <#else/> BILLABLE EXPENSES</#if></b></p>
<table border="1" style="width: 100%; margin-top: 10px;">
		<!-- start items -->
        <#list record.item?sort_by("custcol_oa_date","custcol_oa_wbs_assignees") as item>
        <#if item_index==0>
        <thead>
        <tr border-bottom="1">
        <th colspan="3"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_date}<#else/>Date</#if></th>
		<th colspan="4"> <span style="nowrap;"><span style="nowrap;">
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_name}<#else/>Name</#if></span></span></th>
        <th colspan="13"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_client_notes}<#else/>Client Notes</#if></th>
        <th colspan="3" align="right"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_amount}<#else/>Amount</#if></th>
        </tr>
        </thead>
        </#if>
<#if item.custcol_billable_expense==true>
		<tr>
        <td colspan="3">${item.custcol_oa_date}</td>
    	<td colspan="4">${item.custcol_oa_wbs_assignees}</td>
          <td colspan="13"><#if item.custcol_oa_client_notes?length gt 0>${item.custcol_oa_client_notes} <#else/>${item.custcol_print_description}</#if></td>
        <td colspan="3" align="right">${item.custcol_unit_price}</td>
        </tr></#if>
  		</#list>
        </table>
  		</#if>

              
              
<table line-height="150%" style="margin-top:10px;width:100%;">
		<tr>
        <td style="vertical-align: top; width:57%;">
        <#if record.custbody_remittance_information.custrecord_remittance_message?has_content>
        	<table line-height="105%" border="1" border-color="red" margin-top="5px" style="margin-left:-5px;">
        	<tr>
            <td><b>${record.custbody_remittance_information.custrecord_remittance_message}</b></td>
            </tr>
            </table>
        </#if>

			<table align="top" padding-top="10px" rowspan="10" style="vertical-align: top; width:100%; margin-left:-5px;">
        	<tr>
            <td>
              <#if record.custbody_remittance_information.custrecord_remittance_message?has_content && record.custbody_remittance_information.custrecord_remittance_address?has_content><b style="color:red;"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_remit_to_bank}<#else/>Remit To</#if>:<br/></b>
                  <#else/> <#if record.custbody_remittance_information.custrecord_remittance_address?has_content || record.custbody_remittance_information.custrecord_old_remittance_address?has_content>
                <b><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_remit_to_bank}<#else/>Remit To:</#if></b><br/></#if></#if>

              <#if record.custbody_remittance_information?has_content>
              <#if record.custbody_remittance_information.custrecord_old_remittance_address?has_content>${record.custbody_remittance_information.custrecord_old_remittance_address}
                <#elseif record.custbody_remittance_information.custrecord_remittance_address?has_content>${record.custbody_remittance_information.custrecord_remittance_address}
                  </#if>
                <#else/>
                <b><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_remit_to_bank}<#else/>Remit To</#if>:</b><br/>
                ${subsidiary.mainaddress_text}<br /></#if>


              <#if record.subsidiary.id='69' || record.subsidiary.id='72' || ( record.subsidiary.id='10' && record.total lt 10000) ><br/><br/>
                <a href = "${record.custbody_stripe_invoice_payment_link@url}">Click here to pay this invoice online.</a><br/><br/></#if>

          <#if record.custbody_remittance_information?has_content><br/><br/>
 			<b><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_remittance} <#else/>Information for Electronic Remittance</#if>:</b><br />
            <#if record.custbody_remittance_information.custrecord_bank_name?has_content>
              <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_name_bank}
              <#else/>Bank Name</#if>:&nbsp; &nbsp; ${record.custbody_remittance_information.custrecord_bank_name}<br /></#if>
            <#if record.custbody_remittance_information.custrecord_bank_address?has_content>   
            <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_branch_bank}
               <#else/>Bank Branch</#if>:&nbsp;&nbsp;${record.custbody_remittance_information.custrecord_bank_address}<br /></#if>
            <#if record.custbody_remittance_information.custrecord_bank_accountnum_sortcode?has_content> 
               <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_aba_bank}
               <#else/>Branch Sort Code/ABA</#if>:&nbsp;&nbsp;${record.custbody_remittance_information.custrecord_bank_accountnum_sortcode}<br /></#if>
            <#if record.custbody_remittance_information.custrecord_accountnum?has_content>
			    <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_account_number_bank}
                <#else/>Account Number</#if>:&nbsp; &nbsp; ${record.custbody_remittance_information.custrecord_accountnum}<br /> </#if>
            <#if record.custbody_remittance_information.custrecord_Intermediary_Bank?has_content>
                <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_intermediary_bank}
                <#else/>Intermediary Bank</#if>:&nbsp;&nbsp;${record.custbody_remittance_information.custrecord_Intermediary_Bank}<br /></#if>
            <#if record.custbody_remittance_information.custrecord_swift_code?has_content>
                <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_swift_bic_bank}
                <#else/>SWIFT/BIC</#if>:&nbsp;&nbsp;${record.custbody_remittance_information.custrecord_swift_code}<br /></#if>
            <#if record.custbody_remittance_information.custrecord_iban?has_content> 
                <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_iban_bank}
                <#else/>IBAN:</#if>&nbsp;&nbsp;${record.custbody_remittance_information.custrecord_iban}</#if>
              </#if>
            </td>
            </tr>
            </table>

            
              

		</td>

		<td align="right" rowspan="4" style="vertical-align: top; width:43%;">
            <table border="1" style="width:100%; margin-right:-5px;" >
            <tr>
              <th align="center" colspan="9" style="border-bottom:1px;"><b>
                <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_total_breakdown}
                <#else/>TOTALS BREAKDOWN (${record.currency}) </#if></b></th>
            </tr>
            <tr>
            <td align="right" colspan="5"><b><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_subtotal}<#else/>Subtotal</#if></b></td>
            <td align="right" colspan="4"><#setting number_format=",##0.00">${record.subtotal}&nbsp;&nbsp;${record.currency}</td>
            </tr>
            <tr style="border-top:1px; border-color: #bdc3c7;">
            <td align="right" colspan="5"><b>
              <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_tax}
              <#elseif record.custbody_gst_hst?has_content>${record.custbody_gst_hst}
              <#elseif subsidiary.country='United States'>Tax
              <#elseif subsidiary.country='Australia'>GST
              <#elseif subsidiary.country='New Zealand'>GST
       		  <#elseif subsidiary.country='Singapore'>GST (${(record.taxtotal/record.subtotal)*100}) %
              <#else/>VAT</#if></b></td>
            <td align="right" colspan="4">
              <#if record.custbody_gst_hst='HST' && record.taxtotal !=0> ${record.taxtotal+record.tax2total}<#else/>${record.taxtotal}</#if>&nbsp;&nbsp;${record.currency}</td>
              </tr>
            <#if record.custbody_gst_hst?has_content>
            <tr style="padding-top:-10px;">
            <td align="right" colspan="5" >Reg. No. ${subsidiary.custrecord_ca_gst_hst_id}</td>
            <td align="right" colspan="4"></td>
            </tr></#if>
            <#if (record.custbody_pst_qst_rst?has_content && record.tax2total?has_content && record.tax2total !=0) || (record.custbody_gst_hst='' && record.tax2total?has_content && record.tax2total !=0)>
            <tr style="border-top:1px; border-color: #bdc3c7;">
            <td align="right" colspan="5"><b>${record.custbody_pst_qst_rst}</b></td>
            <td align="right" colspan="4">${record.tax2total}&nbsp;&nbsp;${record.currency}</td>
            </tr></#if>
            <#if record.subsidiary.custrecord_ca_bc_id?has_content && record.shipstate=='BC'>
            <tr style="padding-top:-10px;">
            <td align="right" colspan="5" >Reg. No. ${record.subsidiary.custrecord_ca_bc_id}</td>
            <td align="right" colspan="4"></td>
            </tr></#if>
            <#if record.subsidiary.custrecord_ca_sk_id?has_content && record.shipstate=='SK'>
            <tr style="padding-top:-10px;">
            <td align="right" colspan="5" >Reg. No. ${record.subsidiary.custrecord_ca_sk_id}</td>
            <td align="right" colspan="4" ></td>
            </tr></#if>
            <#if record.subsidiary.custrecord_ca_rst_id?has_content && record.shipstate=='MB'>
            <tr style="padding-top:-10px;">
            <td align="right" colspan="5" >Reg. No. ${record.subsidiary.custrecord_ca_rst_id}</td>
            <td align="right" colspan="4" ></td>
            </tr></#if>
            <#if record.subsidiary.custrecord_ca_qst_id?has_content && record.shipstate=='QC'>
            <tr style="padding-top:-10px;">
            <td align="right" colspan="5" >Reg. No. ${record.subsidiary.custrecord_ca_qst_id}</td>
            <td align="right" colspan="4" ></td>
            </tr></#if>
            <#if record.custbody_reversed_charge==true>
            <tr style="border-top:1px; border-color: #bdc3c7;">
            <td colspan="9" align="center"><b><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_reverse_charge}
              <#else/>REVERSE CHARGE</#if></b></td>
            </tr></#if>
            <tr style="border-top:1px; border-color: #bdc3c7;">
            <td align="right" colspan="5"><b><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_total}<#else/>Total</#if></b></td>
            <td align="right" colspan="4" >${record.total}&nbsp;&nbsp;${record.currency}</td>
            </tr>
            <#if record.subsidiary.custrecord_exclude_credit_balance ==false>
            <tr style="border-top:1px; border-color: #bdc3c7;">
            <td align="right" colspan="5" ><b><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_credits_payments}
              <#else/>Credits/Payments</#if></b></td>
            <td align="right" colspan="4" >(${record.amountpaid})  ${record.currency}</td>
              </tr>
            <tr style="border-top:1px; border-color: #bdc3c7;">
            <td align="right" colspan="5" ><b>
              <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_balance}<#else/>Amount Due</#if></b></td>
            <td align="right" colspan="4" ><b>${record.amountremaining}&nbsp;&nbsp;${record.currency}</b></td>
              </tr></#if>
            </table>
                
            <#if record.custbody_reversed_charge==true>
              <table  margin-top="20px" style="width:100%;">
              <tr>
              <td>${subsidiary.custrecord_reversed_charge_message} </td>
              </tr>
              </table></#if>

<#-- PRINT TAX DETAILS FOR SG AND UK -->

             <#if (subsidiary.country='Singapore' && record.currency !='SGD') || (subsidiary.country='United Kingdom' && record.currency !='GBP')>
              <table border="1" style="width:100%; margin-right:-5px; margin-top: 5px;">
              <tr>
                <th align="center" colspan="9" style="border-bottom:1px;"><b>
                  <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_tax}
                  <#elseif record.custbody_gst_hst?has_content>${record.custbody_gst_hst}
                  <#elseif subsidiary.country='United States'>Tax
                  <#elseif subsidiary.country='Australia'>GST
                  <#elseif subsidiary.country='New Zealand'>GST
                  <#elseif subsidiary.country='Singapore'>GST
                  <#else/>VAT</#if> INFORMATION (${subsidiary.currency})</b></th></tr>
                <tr>
                <td align="right" colspan="5" font-size="7pt"><b>Exchange Rate:</b></td>
                <td align="right" colspan="4">${record.exchangerate?string("##0.000000")}  ${subsidiary.currency}</td>
                </tr>
                <tr>
                <td align="right" colspan="5" font-size="7pt"><b>Total Amt Payable Before Tax:</b></td>
                <td align="right" colspan="4">${record.subtotal*record.exchangerate}  ${subsidiary.currency}</td>
                </tr> 
                <tr>
                <td align="right" colspan="5" font-size="7pt"><b>Total Tax Chargeable:</b></td>
                <td align="right" colspan="4">${record.taxtotal*record.exchangerate}  ${subsidiary.currency}</td>
                </tr> 
                <tr>
                <td align="right" colspan="5" font-size="7pt"><b>Total Amt Payable Incl Tax:</b></td>
                <td align="right" colspan="4"><b>${record.total*record.exchangerate}  ${subsidiary.currency}</b></td>
                </tr>
               </table></#if>     
                
                
               </td>
          </tr>
              </table>

              
              
		<table style="width: 100%; margin-top: 10px; margin-bottom: -10px;">
		<tr>
        <td align="center"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_thank_you}!
          <#else/>Thank you for your business!</#if></td>
    	</tr>
  		<#if subsidiary.custrecord_ar_phonenum?has_content || subsidiary.email?has_content>
  		<tr>
    	<td align="center" padding-top="5px" padding-bottom="8px"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_billing_questions}
          <#else/>Billing Questions</#if>:&nbsp;&nbsp;&nbsp;${subsidiary.custrecord_ar_phonenum} &nbsp;&nbsp;&nbsp;${subsidiary.email}</td>
  		</tr>
        </#if>
  		</table>

</body>
</pdf>
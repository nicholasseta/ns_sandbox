<?xml version="1.0"?>
<!DOCTYPE pdf PUBLIC "-//big.faceless.org//report" "report-1.1.dtd">
<pdf>

    <head>
      <link name="NotoSans" type="font" subtype="truetype" src="${nsfont.NotoSans_Regular}" src-bold="${nsfont.NotoSans_Bold}" src-italic="${nsfont.NotoSans_Italic}" src-bolditalic="${nsfont.NotoSans_BoldItalic}" bytes="2" />
      <#if .locale=="zh_CN">
      <link name="NotoSansCJKsc" type="font" subtype="opentype" src="${nsfont.NotoSansCJKsc_Regular}" src-bold="${nsfont.NotoSansCJKsc_Bold}" bytes="2" />
      <#elseif .locale=="zh_TW">
      <link name="NotoSansCJKtc" type="font" subtype="opentype" src="${nsfont.NotoSansCJKtc_Regular}" src-bold="${nsfont.NotoSansCJKtc_Bold}" bytes="2" />
      <#elseif .locale=="ja_JP">
      <link name="NotoSansCJKjp" type="font" subtype="opentype" src="${nsfont.NotoSansCJKjp_Regular}" src-bold="${nsfont.NotoSansCJKjp_Bold}" bytes="2" />
      <#elseif .locale=="ko_KR">
      <link name="NotoSansCJKkr" type="font" subtype="opentype" src="${nsfont.NotoSansCJKkr_Regular}" src-bold="${nsfont.NotoSansCJKkr_Bold}" bytes="2" />
      <#elseif .locale=="th_TH">
      <link name="NotoSansThai" type="font" subtype="opentype" src="${nsfont.NotoSansThai_Regular}" src-bold="${nsfont.NotoSansThai_Bold}" bytes="2" />
      </#if>
	<macrolist>
      <macro id="nlheader">

<table line-height="100%" style="width: 100%;">
      <tr>
      <td valign="top" rowspan="11" width="50%">
       <#if subsidiary.logo@url?has_content><img src="${subsidiary.logo@url}" style="float: left;"/></#if><br/><p valign="top" style="font-size:10px">
       ${subsidiary.mainaddress_text}</p></td>
      <td align="right" colspan="4" font-size="20px">&nbsp;</td>
      <td align="left" colspan="4" font-size="20px"><b><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_creditmemo}<#else/>Credit Memo</#if></b></td>
	  </tr>
	  <tr>
      <td align="right" colspan="4"> <#if record.custbody_invoice_label_translation?has_content> ${record.custbody_invoice_label_translation.custrecord_inv_label_date} <#else/>Date</#if></td>
      <td align="left" colspan="4"> <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${record.trandate?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${record.trandate?string('dd-MMM-yyyy')} <#else/>${record.trandate?string('MMM-dd-yyyy')}</#if></td>
      </tr>
      <tr>
      <td align="right" colspan="4"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_creditmemo}<#else/>Credit Memo#</#if></td>
      <td align="left" colspan="4"><b><#if record.custbody_legacy_transaction_number?has_content> ${record.custbody_legacy_transaction_number} <#else/> ${subsidiary.id}-${record.tranid}</#if></b></td>
      </tr>
      <tr>
      <td align="right" colspan="4"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_po} <#else/>PO#</#if></td>
      <td align="left" colspan="4">${record.otherrefnum}</td>
      </tr>
	  <#if subsidiary.custrecord_subsidiary_group!='Viareport'>
      <tr>
      <td align="right" colspan="4"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_ordertype}<#else/>Order Type</#if></td>
      <td align="left" colspan="4">${record.custbody_so_ordertype}</td>
      </tr></#if>
      <tr>
      <td align="right" colspan="4" padding-top="5px">
       <#if record.subsidiary.taxidnum?has_content>
       <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_taxid}  
       <#elseif subsidiary.country='United States'>EIN# <#elseif subsidiary.country='Australia'> ABN <#elseif subsidiary.country='Ireland'>VAT No: IE 
        <#elseif subsidiary.country='United Kingdom'>VAT No: GB <#elseif subsidiary.country='Canada'> <#else/> VAT No </#if></#if></td>
      <td align="left" colspan="4" padding-top="5px"><#if subsidiary.country!='Canada'>${record.subsidiary.taxidnum}</#if></td>
      </tr>
      <#if subsidiary.country='Australia'>
      <tr>
      <td align="right" colspan="4"><#if subsidiary.state1taxnumber?has_content>ACN:</#if></td>
      <td align="left" colspan="4">${subsidiary.state1taxnumber}</td>
      </tr></#if>
      </table>
      </macro>

      <macro id="nlfooter">
      <table class="footer" style="width: 100%;">
      <tr>
      <td align="right"><pagenumber /> of <totalpages /></td>
      </tr>  
      </table>
      </macro>
      </macrolist>

      <style type="text/css">
        * {
          <#if .locale=="zh_CN">font-family: NotoSans, NotoSansCJKsc, sans-serif;
          <#elseif .locale=="zh_TW">font-family: NotoSans, NotoSansCJKtc, sans-serif;
          <#elseif .locale=="ja_JP">font-family: NotoSans, NotoSansCJKjp, sans-serif;
          <#elseif .locale=="ko_KR">font-family: NotoSans, NotoSansCJKkr, sans-serif;
          <#elseif .locale=="th_TH">font-family: NotoSans, NotoSansThai, sans-serif;
          <#else>font-family: NotoSans, sans-serif;
          </#if>
        }

        table {
          font-size: 9pt;
          table-layout: fixed;
        }

        th {
          font-weight: bold;
          font-size: 8pt;
          vertical-align: middle;
          padding: 5px 6px 3px;
          background-color: #e3e3e3;
          color: #333333;
        }

        td {
          padding: 4px 6px;
        }

        td p {
          text-align: left
        }

        b {
          font-weight: bold;
          color: #333333;
        }

        table.header td {
          padding: 0px;
          font-size: 10px;
        }

        table.footer td {
          padding: 0px;
          font-size: 9pt;
        }

        table.itemtable th {
          padding-bottom: 10px;
          padding-top: 10px;
        }

        table.body td {
          padding-top: 2px;
        }

        table.total {
          page-break-inside: avoid;
        }

        tr.totalrow {
          background-color: #e3e3e3;
          line-height: 200%;
        }

        td.totalboxtop {
          font-size: 12pt;
          background-color: #e3e3e3;
        }

        td.addressheader {
          font-size: 8pt;
          padding-top: 6px;
          padding-bottom: 2px;
        }

        td.address {
          padding-top: 0px;
        }

        td.totalboxmid {
          font-size: 28pt;
          padding-top: 20px;
          background-color: #e3e3e3;
        }

        td.totalboxbot {
          background-color: #e3e3e3;
          font-weight: bold;
        }

        span.title {
          font-size: 28pt;
        }

        span.number {
          font-size: 16pt;
        }

        span.itemname {
          font-weight: bold;
          line-height: 150%;
        }

        hr {
          width: 100%;
          color: #d3d3d3;
          background-color: #d3d3d3;
          height: 1px;
        }
      </style>
    </head>

        <body header="nlheader" header-height="20%" footer="nlfooter" padding="0.25in 0.25in 0.25in 0.25in" size="Letter">

<table style="width: 100%; margin-top: 10px;">
        <tr >
        <td class="address" colspan="3" style="padding-left: 2px;"><b>
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_billaddress}<#else>Bill To</#if>:</b></td>
        <td class="address" colspan="3" style="padding-left: 40px;"><b>
          <#if record.subsidiary.custrecord_print_shipto_address==true><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_shipaddress}
            <#else/>Ship To</#if>:</#if></b></td>
        </tr>
        <tr>
        <td class="address" colspan="3" rowspan="2">
        	<#if record.custbody_bill_to_address_override?has_content>${record.custbody_bill_to_address_override}&nbsp;
            <#elseif record.billaddressee="" && record.billcountry=='DE'>
            ${record.entity.companyname}<br />
            <#if record.billattention?has_content>${record.billattention}<br/></#if>
            <#if record.billaddr1?has_content>${record.billaddr1}<br/></#if>
            <#if record.billaddr2?has_content>${record.billaddr2}<br/></#if>
            <#if record.billzip?has_content>${record.billzip}</#if>  <#if record.billcity?has_content>${record.billcity}<br/></#if> 
			<#if record.billstate?has_content>${record.billstate}<br/></#if> 
            ${record.billingaddress.country}
            <#elseif record.billaddressee="">${record.entity.companyname}<br />${record.billaddress}&nbsp; 
            <#elseif record.billcountry=='DE'>
            <#if record.billaddressee?has_content>${record.billaddressee}<br/></#if>
            <#if record.billattention?has_content>${record.billattention}<br/></#if>
            <#if record.billaddr1?has_content>${record.billaddr1}<br/></#if>
            <#if record.billaddr2?has_content>${record.billaddr2}<br/></#if>
            <#if record.billzip?has_content>${record.billzip}</#if>  <#if record.billcity?has_content>${record.billcity}<br/></#if> 
 			<#if record.billstate?has_content>${record.billstate}<br/></#if> 
            ${record.billingaddress.country}
            <#else/> ${record.billaddress}&nbsp;
            </#if>

              <#if record.entity.vatregnumber?has_content> <br /> <br /> <b><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_taxid} 
              <#elseif record.billcountry=='US'>EIN#: <#elseif record.billcountry=='AU'>ABN:  <#elseif record.billcountry=='NZ'>ABN: <#elseif record.billcountry=='CA'>TAX ID: <#else/>VAT: </#if></b>${record.entity.vatregnumber}</#if></td>

		<td class="address" colspan="3" padding-left=".5in">
        <#if record.subsidiary.custrecord_print_shipto_address==true>${record.shipaddress}</#if></td>
        </tr>
        <tr>
        </tr>
        <tr>
        <td class="address" colspan="3">&nbsp;</td>
        <td class="address" colspan="3">&nbsp;</td>
        </tr>
        <tr>
        <td class="address" colspan="3" padding-top="10" ><b><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_enduser}<#else>End User</#if>:</b></td>
        <td class="address" colspan="3" padding-top="10" style="padding-left: 40px;"><b><#if record.custbody_invoice_label_translation?has_content> ${record.custbody_invoice_label_translation.custrecord_inv_label_invoice_contact}<#else>Contact</#if>:</b></td>
        </tr>
        <tr>
        <td class="address" colspan="3" >${record.custbody_so_enduser.altname}</td>
        <td class="address" colspan="3" padding-left=".5in">${record.custbody_invoice_contact.firstname}&nbsp;${record.custbody_invoice_contact.middlename}&nbsp;${record.custbody_invoice_contact.lastname}</td>
        </tr>
        <#if record.custbody_distributor == record.entity>  
        <tr>
        <td class="address" colspan="3" padding-top="10"><b><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_partner_jv_reseller}<#else/>Partner/JV/Reseller</#if>:</b></td>
        <td class="address" colspan="3">&nbsp;</td>
        </tr>
        <tr>
        <td class="address" colspan="3">${record.custbody_partnerjvreseller.altname}</td>
        <td class="address" colspan="3">&nbsp;</td>
        </tr></#if>
        </table>


<#if subsidiary.country='Germany' || record.message?has_content || record.custbody_invoice_message?has_content>
<table style="width: 100%; margin-top: 10px;">
        <tr>
          <td class="address"><b><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_message}<#else/>Invoice Message:</#if></b></td>
		</tr>
        <tr>
        <td> <#if subsidiary.country='Germany'>If no other period is indicated, then delivery was made in the same period as the invoice. </#if>${record.message} ${record.custbody_invoice_message}</td>
  		</tr>
      </table></#if>

<#-- Print items as is -->
<#if record.item?has_content>
<#if record.custbody_expand_licenses_on_invoice==true>
  <table border="1" class="itemtable" style="width: 100%; margin-top: 10px;">
  <!-- start items -->
        <#list record.item as item>
        <#if item_index==0>
        <thead>
        <tr border-bottom="1">
        <th align="center" border-color="#bdc3c7" border-right="1" colspan="3">
          <#if record.custbody_invoice_label_translation?has_content> ${record.custbody_invoice_label_translation.custrecord_inv_label_item}<#else/>Item</#if></th>
        <th border-color="#bdc3c7" border-right="1" colspan="6">
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_description}<#else/>Description</#if></th>
        <#if record.subsidiary.custrecord_print_erp_epm==true>
        <th align="center" border-color="#bdc3c7" border-right="1" colspan="3"><p>
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_erp_epm}<#else/>ERP/EPM</#if></p></th></#if>
        <th align="center" border-color="#bdc3c7" border-right="1" colspan="2">
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_quantity}<#else/>Quantity</#if></th>
        <#if record.subsidiary.custrecord_print_unit_price==true>
        <th align="center" border-color="#bdc3c7" border-right="1" colspan="3">
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_unit_price}<#else/>Unit Price</#if></th></#if>
        <#if subsidiary.custrecord_print_discount_gross_amount==true && record.custbody_print_discount=='T'>
        <th align="center" border-color="#bdc3c7" border-right="1" colspan="3"><span style="nowrap;">
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_gross_amount}<#else/>Gross<br/>Amount</#if></span></th>
        <th align="center" border-color="#bdc3c7" border-right="1" colspan="2">
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_discount}<#else/>Discount</#if></th></#if>
        <th align="right" border-color="#bdc3c7" border-right="1" colspan="3"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_amount}<#else/>Amount</#if></th>
        <#if record.subsidiary.custrecord_print_tax_column==true>
        <th align="right" border-color="#bdc3c7" border-right="1" colspan="2">
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_tax}<#else/>Tax</#if></th></#if>
        </tr>
        </thead>
        </#if>

<#-- Print the bundle -->          
<#if item.custcol_total_by_bundle!=0>
		<tr>
        <td align="left" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_bundle_name}</td>
        <td border-right="1" colspan="6" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_bundle_description}
        <#if item.custcol_term_start_date?has_content><br />
          <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_start_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_start_date?string('dd-MMM-yyyy')}<#else/>${item.custcol_term_start_date?string('MMM-dd-yyyy')}</#if></#if>
        <#if item.custcol_term_end_date?has_content> to <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_end_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_end_date?string('dd-MMM-yyyy')} 
          <#else/>${item.custcol_term_end_date?string('MMM-dd-yyyy')}</#if></#if></td>
        <#if record.subsidiary.custrecord_print_erp_epm==true>
        <td align="center" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.class}</td></#if>
        <td align="right"  padding-right="20px" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${((item.custcol_print_qty)*(-1))?string("(,###.##);###.##")}</td>
        <#if record.subsidiary.custrecord_print_unit_price==true>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
        <#setting number_format=",##0.00">${((item.custcol_total_by_bundle)*(-1))?string(",##0.00;(##0.00)")}</td></#if>
        <#if subsidiary.custrecord_print_discount_gross_amount==true && record.custbody_print_discount=='T'>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"> <#setting number_format=",##0.00"></td>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"></td></#if>
		<td align="right" colspan="3" line-height="150%" style="border-bottom:1; border-right:1; border-color: #bdc3c7;"><#setting number_format=",##0.00">${((item.custcol_total_by_bundle)*(-1))?string(",##0.00;(##0.00)")}</td>
		<#if record.subsidiary.custrecord_print_tax_column==true>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"></td></#if>
		</tr>          

<#-- Print Syntec bundle -->          
<#elseif item.custcol_syntec_total_by_bundle!=0>
		<tr>
        <td align="left" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.item}</td>
        <td border-right="1" colspan="6" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.description}
        <#if item.custcol_term_start_date?has_content><br />
          <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_start_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_start_date?string('dd-MMM-yyyy')}<#else/>${item.custcol_term_start_date?string('MMM-dd-yyyy')}</#if></#if>
        <#if item.custcol_term_end_date?has_content> to <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_end_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_end_date?string('dd-MMM-yyyy')} 
          <#else/>${item.custcol_term_end_date?string('MMM-dd-yyyy')}</#if></#if></td>
        <#if record.subsidiary.custrecord_print_erp_epm==true>
        <td align="center" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.class}</td></#if>
        <td align="right"  padding-right="20px" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${((item.custcol_print_qty)*(-1))?string("(,###.##);###.##")}</td>
        <#if record.subsidiary.custrecord_print_unit_price==true>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
        <#setting number_format=",##0.00">${((item.custcol_syntec_total_by_bundle)*(-1))?string(",##0.00;(##0.00)")}</td></#if>
        <#if subsidiary.custrecord_print_discount_gross_amount==true && record.custbody_print_discount=='T'>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"> <#setting number_format=",##0.00"></td>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"></td></#if>
		<td align="right" colspan="3" line-height="150%" style="border-bottom:1; border-right:1; border-color: #bdc3c7;"><#setting number_format=",##0.00">${((item.custcol_syntec_total_by_bundle)*(-1))?string(",##0.00;(##0.00)")}</td>
		<#if record.subsidiary.custrecord_print_tax_column==true>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"></td></#if>
		</tr>                    
          
<#elseif item.custcol_print_time_entry==false && item.custcol_print_milestone_item==false && item.custcol_bundle_name?length=0>
		<tr>
        <td align="left" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
        <#if record.subsidiary.custrecord_print_product_code==true && item.custcol_item_display_name?has_content>${item.custcol_item_display_name} <#elseif item.custcol_item_name_translated?has_content> ${item.custcol_item_name_translated}<#else/>${item.item}</#if></td>
        <td border-right="1" colspan="6" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.description}
        <#if item.custcol_term_start_date?has_content><br />
          <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_start_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_start_date?string('dd-MMM-yyyy')}<#else/>${item.custcol_term_start_date?string('MMM-dd-yyyy')}</#if></#if>
        <#if item.custcol_term_end_date?has_content> to <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_end_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_end_date?string('dd-MMM-yyyy')} 
          <#else/>${item.custcol_term_end_date?string('MMM-dd-yyyy')}</#if></#if></td>
        <#if record.subsidiary.custrecord_print_erp_epm==true>
        <td align="center" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.class}</td></#if>
        <td align="right"  padding-right="20px" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${((item.custcol_print_qty)*(-1))?string("(,###.##);###.##")}</td>
        <#if record.subsidiary.custrecord_print_unit_price==true>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
        <#setting number_format=",##0.00">${((item.custcol_gross_unit_price/item.quantity)*(-1))?string(",##0.00;(##0.00)")}</td></#if>
        <#if subsidiary.custrecord_print_discount_gross_amount==true && record.custbody_print_discount=='T'>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"> <#setting number_format=",##0.00">${((item.custcol_gross_unit_price)*(-1))?string(",##0.00;(##0.00)")}</td>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_discount_precent?string.percent}</td></#if>
		<td align="right" colspan="3" line-height="150%" style="border-bottom:1; border-right:1; border-color: #bdc3c7;"><#setting number_format=",##0.00">${((item.amount)*(-1))?string(",##0.00;(##0.00)")}</td>
		<#if record.subsidiary.custrecord_print_tax_column==true>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"><#setting number_format=",##0.###">${item.taxrate1 * 100}%</td></#if>
		</tr>
  
<#elseif item.custcol_total_amount_by_item?has_content && item.custcol_total_amount_by_item!=0 && item.custcol_bundle_name?length=0>
		<tr>
        <td align="left" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
        <#if record.subsidiary.custrecord_print_product_code==true && item.custcol_item_display_name?has_content>${item.custcol_item_display_name} <#elseif item.custcol_item_name_translated?has_content> ${item.custcol_item_name_translated}<#else/>${item.item}</#if></td>
        <td border-right="1" colspan="6" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.description}
        <#if item.custcol_term_start_date?has_content><br />
          <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_start_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_start_date?string('dd-MMM-yyyy')}<#else/>${item.custcol_term_start_date?string('MMM-dd-yyyy')}</#if></#if>
        <#if item.custcol_term_end_date?has_content> to <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_end_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_end_date?string('dd-MMM-yyyy')} 
          <#else/>${item.custcol_term_end_date?string('MMM-dd-yyyy')}</#if></#if></td>
        <#if record.subsidiary.custrecord_print_erp_epm==true>
        <td align="center" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.class}</td></#if>
        <td align="right"  padding-right="20px" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${((item.custcol_print_total_qty_byitem)*(-1))?string("(,###.##);###.##")}</td>
        <#if record.subsidiary.custrecord_print_unit_price==true>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
        <#setting number_format=",##0.00">${((item.custcol_gross_unit_price/item.quantity)*(-1))?string(",##0.00;(##0.00)")}</td></#if>
        <#if subsidiary.custrecord_print_discount_gross_amount==true && record.custbody_print_discount=='T'>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"> <#setting number_format=",##0.00">${((item.custcol_gross_unit_price)*(-1))?string(",##0.00;(##0.00)")}</td>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_discount_precent?string.percent}</td></#if>
		<td align="right" colspan="3" line-height="150%" style="border-bottom:1; border-right:1; border-color: #bdc3c7;"><#setting number_format=",##0.00">${((item.custcol_total_amount_by_item)*(-1))?string(",##0.00;(##0.00)")}</td>
		<#if record.subsidiary.custrecord_print_tax_column==true>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"><#setting number_format=",##0.###">${item.taxrate1 * 100}%</td></#if>
		</tr>  
  
  
  </#if>
		</#list>
		</table>
<#-- Print items grouped by Recurring Subscription (On-Prem Term License) Revenue and SaaS Revenue and if Order type is renewal, or if item is a commission item. See the custom field Print Description -->
<#else/>
		<table border="1" class="itemtable" style="width: 100%; margin-top: 10px;">
        <!-- start items -->
        <#list record.item as item>
        <#if item_index==0>
        <thead>
        <tr border-bottom="1">
        <th align="center" border-color="#bdc3c7" border-right="1" colspan="3">
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_item}<#else/>Item</#if></th>
        <th border-color="#bdc3c7" border-right="1" colspan="6">
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_description}<#else/>Description</#if></th>
        <#if record.subsidiary.custrecord_print_erp_epm==true>
        <th align="center" border-color="#bdc3c7" border-right="1" colspan="3"><p><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_erp_epm}<#else/>ERP/EPM</#if></p></th></#if>
        <th align="center" border-color="#bdc3c7" border-right="1" colspan="2"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_quantity}<#else/>Quantity</#if></th>
        <#if record.subsidiary.custrecord_print_unit_price==true>
        <th align="center" border-color="#bdc3c7" border-right="1" colspan="3"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_unit_price}<#else/>Unit Price</#if></th></#if>
        <#if subsidiary.custrecord_print_discount_gross_amount==true && record.custbody_print_discount=='T'>
        <th align="center" border-color="#bdc3c7" border-right="1" colspan="3"><span style="nowrap;">
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_gross_amount}<#else/>Gross<br/>Amount</#if></span></th>
        <th align="center" border-color="#bdc3c7" border-right="1" colspan="2">
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_discount}<#else/>Discount</#if></th></#if>
        <th align="right" border-color="#bdc3c7" border-right="1" colspan="3">
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_amount}<#else/>Amount</#if></th>
		<#if record.subsidiary.custrecord_print_tax_column==true>
        <th align="right" border-color="#bdc3c7" border-right="1" colspan="2">
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_tax}<#else/>Tax</#if></th></#if>
        </tr>
        </thead>
        </#if>

<#-- Print the bundle -->          
<#if item.custcol_total_by_bundle!=0>
		<tr>
        <td align="left" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_bundle_name}</td>
        <td border-right="1" colspan="6" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_bundle_description}
		  <#if item.custcol_term_start_date?has_content><br />
          <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_start_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_start_date?string('dd-MMM-yyyy')}<#else/>${item.custcol_term_start_date?string('MMM-dd-yyyy')}</#if></#if>
        <#if item.custcol_term_end_date?has_content> to <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_end_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_end_date?string('dd-MMM-yyyy')} 
          <#else/>${item.custcol_term_end_date?string('MMM-dd-yyyy')}</#if></#if></td>
        <#if record.subsidiary.custrecord_print_erp_epm==true>  
        <td align="center" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_print_erp_epm}</td></#if>
        <td align="right" padding-right="20px" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${((item.custcol_print_qty)*(-1))?string("(,###.##);###.##")}</td>
        <#if record.subsidiary.custrecord_print_unit_price==true>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
          <#setting number_format=",##0.00">${((item.custcol_total_by_bundle)*(-1))?string(",##0.00;(##0.00)")}</td></#if>
        <#if subsidiary.custrecord_print_discount_gross_amount==true && record.custbody_print_discount=='T'>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"><#setting number_format=",##0.00"></td>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"></td></#if>
        <td align="right" colspan="3" line-height="150%" style="border-bottom:1; border-right:1; border-color: #bdc3c7;"><#setting number_format=",##0.00">${((item.custcol_total_by_bundle)*(-1))?string(",##0.00;(##0.00)")}</td>
        <#if record.subsidiary.custrecord_print_tax_column==true>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"></td></#if>
        </tr>  
          
<#-- Print Syntec bundle -->          
<#elseif item.custcol_syntec_total_by_bundle!=0>
		<tr>
        <td align="left" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.item}</td>
        <td border-right="1" colspan="6" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.description}
		  <#if item.custcol_term_start_date?has_content><br />
          <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_start_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_start_date?string('dd-MMM-yyyy')}<#else/>${item.custcol_term_start_date?string('MMM-dd-yyyy')}</#if></#if>
        <#if item.custcol_term_end_date?has_content> to <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_end_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_end_date?string('dd-MMM-yyyy')} 
          <#else/>${item.custcol_term_end_date?string('MMM-dd-yyyy')}</#if></#if></td>
        <#if record.subsidiary.custrecord_print_erp_epm==true>  
        <td align="center" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_print_erp_epm}</td></#if>
        <td align="right" padding-right="20px" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${((item.custcol_print_qty)*(-1))?string("(,###.##);###.##")}</td>
        <#if record.subsidiary.custrecord_print_unit_price==true>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
          <#setting number_format=",##0.00">${((item.custcol_syntec_total_by_bundle)*(-1))?string(",##0.00;(##0.00)")}</td></#if>
        <#if subsidiary.custrecord_print_discount_gross_amount==true && record.custbody_print_discount=='T'>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"><#setting number_format=",##0.00"></td>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"></td></#if>
        <td align="right" colspan="3" line-height="150%" style="border-bottom:1; border-right:1; border-color: #bdc3c7;"><#setting number_format=",##0.00">${((item.custcol_syntec_total_by_bundle)*(-1))?string(",##0.00;(##0.00)")}</td>
        <#if record.subsidiary.custrecord_print_tax_column==true>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"></td></#if>
        </tr>           
          
  
<#-- Print items grouped by Recurring Subscription (On-Prem Term License) Revenue and SaaS Revenue and if Order type is renewal, or if item is a commission item. See the custom field Print Description -->
<#elseif item.custcol_print_amount_grouped_yn=='Y' && item.custcol_print_time_entry==false && item.custcol_print_milestone_item==false && item.custcol_bundle_name?length=0>
		<tr>
        <td align="left" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"> 
          <#if item.custcol_item_name_translated?has_content> ${item.custcol_item_name_translated}<#else/>${item.custcol_print_item}</#if></td>
        <td border-right="1" colspan="6" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_print_description}
		  <#if item.custcol_term_start_date?has_content><br />
          <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_start_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_start_date?string('dd-MMM-yyyy')}<#else/>${item.custcol_term_start_date?string('MMM-dd-yyyy')}</#if></#if>
        <#if item.custcol_term_end_date?has_content> to <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_end_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_end_date?string('dd-MMM-yyyy')} 
          <#else/>${item.custcol_term_end_date?string('MMM-dd-yyyy')}</#if></#if></td>
        <#if record.subsidiary.custrecord_print_erp_epm==true>  
        <td align="center" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_print_erp_epm}</td></#if>
        <td align="right" padding-right="20px" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${((item.custcol_print_qty)*(-1))?string("(,###.##);###.##")}</td>
        <#if record.subsidiary.custrecord_print_unit_price==true>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
          <#setting number_format=",##0.00">${((item.custcol_print_item_rate)*(-1))?string(",##0.00;(##0.00)")}</td></#if>
        <#if subsidiary.custrecord_print_discount_gross_amount==true && record.custbody_print_discount=='T'>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"><#setting number_format=",##0.00">${((item.custcol_print_gross_unit_price)*(-1))?string(",##0.00;(##0.00)")}</td>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_discount_precent?string.percent}</td></#if>
        <td align="right" colspan="3" line-height="150%" style="border-bottom:1; border-right:1; border-color: #bdc3c7;"><#setting number_format=",##0.00">${((item.custcol_print_amount)*(-1))?string(",##0.00;(##0.00)")}</td>
        <#if record.subsidiary.custrecord_print_tax_column==true>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"><#setting number_format=",##0.###">${item.taxrate1 * 100}%</td></#if>
        </tr>

<#-- Print milestone items, actual charge-->
<#elseif item.custcol_print_milestone_item==true && item.item !="OpenAir Integration">
		<tr>
        <td align="left" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
          <#if item.custcol_item_name_translated?has_content> ${item.custcol_item_name_translated}<#else/>${item.custcol_print_item}</#if></td>
        <td border-right="1" colspan="6" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_print_description}
		<#if item.custcol_term_start_date?has_content><br /> <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_start_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_start_date?string('dd-MMM-yyyy')} <#else/>${item.custcol_term_start_date?string('MMM-dd-yyyy')}</#if></#if>
          <#if item.custcol_term_end_date?has_content> to <#if record.subsidiary.custrecord_pdf_date_format='YYYY-MMM-DD'>${item.custcol_term_end_date?string('yyyy-MMM-dd')} <#elseif record.subsidiary.custrecord_pdf_date_format='DD-MMM-YYYY'>${item.custcol_term_end_date?string('dd-MMM-yyyy')} <#else/>${item.custcol_term_end_date?string('MMM-dd-yyyy')}</#if></#if> </td>
        <#if record.subsidiary.custrecord_print_erp_epm==true>  
        <td align="center" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_print_erp_epm}</td></#if>
        <td align="right" padding-right="20px" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${((item.custcol_print_qty)*(-1))?string("(,###.##);###.##")}</td>
        <#if record.subsidiary.custrecord_print_unit_price==true>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
          <#setting number_format=",##0.00">${((item.custcol_print_item_rate)*(-1))?string(",##0.00;(##0.00)")}</td></#if>
        <#if subsidiary.custrecord_print_discount_gross_amount==true && record.custbody_print_discount=='T'>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${((item.custcol_print_gross_unit_price)*(-1))?string(",##0.00;(##0.00)")}</td>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_discount_precent?string.percent}</td></#if>
        <td align="right" colspan="3" line-height="150%" style="border-bottom:1; border-right:1; border-color: #bdc3c7;"><#setting number_format=",##0.00">${((item.custcol_print_amount)*(-1))?string(",##0.00;(##0.00)")}</td>
        <#if record.subsidiary.custrecord_print_tax_column==true>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"><#setting number_format=",##0.###">${item.taxrate1 * 100}%</td></#if>  
        </tr>

<#-- Print time entries, actual charge -->
<#elseif item.custcol_print_total_qty_byitem?has_content && item.custcol_print_time_entry==true && item.item !="OpenAir Integration">
        <tr>
        <td align="left" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
          <#if item.custcol_item_name_translated?has_content> ${item.custcol_item_name_translated}<#else/>${item.custcol_print_item}</#if></td>
        <td border-right="1" colspan="6" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_print_description}</td>
        <#if record.subsidiary.custrecord_print_erp_epm==true>
        <td align="center" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${item.custcol_print_erp_epm}</td></#if>
        <td align="right" padding-right="20px" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">${((item.custcol_print_total_qty_byitem)*(-1))?string("(,###.##);###.##")}</td>
        <#if record.subsidiary.custrecord_print_unit_price==true>
        <td align="right" border-right="1" colspan="3" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;">
          <#setting number_format=",##0.00">
            <#if item.custcol_print_total_qty_byitem!=0 && item.custcol_total_amount_by_item?has_content && item.custcol_total_amount_by_item!=0>${((item.custcol_total_amount_by_item/item.custcol_print_total_qty_byitem)*(-1))?string(",##0.00;(##0.00)")}
              <#else/>${((record.subtotal / item.custcol_print_total_qty_byitem)*(-1))?string(",##0.00;(##0.00)")}</#if></td></#if>
        <td align="right" colspan="3" line-height="150%" style="border-bottom:1; border-right:1; border-color: #bdc3c7;">
          <#if (item.custcol_total_amount_by_item?has_content && item.custcol_total_amount_by_item!=0)> <#setting number_format=",##0.00">${((item.custcol_total_amount_by_item)*(-1))?string(",##0.00;(##0.00)")} 
            <#else/>${record.subtotal}</#if></td>
		<#if record.subsidiary.custrecord_print_tax_column==true>
        <td align="right" border-right="1" colspan="2" line-height="150%" style="border-bottom:1; border-color: #bdc3c7;"><#setting number_format=",##0.###">${item.taxrate1 * 100}%</td></#if>
        </tr></#if>
        </#list>
        </table>
        </#if>
        </#if>

<#-- Additional table -->          
<#-- Print milestone items in another table to show the details -->
<#if record.item?has_content && record.custbody_print_milestone=='T'>
		<p font-size="10px"><b><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_fixed_fee_details}
          <#else/>Fixed Fee Details</#if></b>
        </p>
<table border="1" style="width: 100%; margin-top: 10px;">
		<!-- start items -->
        <#list record.item as item>
        <#if item_index==0>
        <thead>
        <tr border-bottom="1">
        <th colspan="3"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_date}<#else/>Date</#if></th>
        <th colspan="16"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_Description}<#else/>Description</#if></th>
        <th colspan="2" align="right"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_amount}<#else/>Amount</#if></th>
        </tr>
        </thead>
        </#if>
<#if item.custcol_print_milestone_item==true>
		<tr>
        <td colspan="3">${item.custcol_oa_date}</td>
        <td colspan="16">${item.description}</td>
		<#setting number_format=",##0.00">
        <td colspan="2" align="right">${((item.custcol_unit_price)*(-1))?string(",##0.00;(##0.00)")}</td>
        </tr></#if>
        </#list>
  		</table>
  		</#if>

<#-- Print time entries in another table to show the details -->
<#if record.item?has_content && ((record.custbody_print_time_entry=='T' && record.custbody_expand_service_items==true) || (record.custbody_print_time_entry=='T' && subsidiary.custrecord_expand_service_items_invoice==true))>
		<p font-size="10px"><b>SERVICE DETAILS</b>
		</p>
<table border="1" style="width: 100%; margin-top: 10px;">
		<!-- start items -->
        <#list record.item as item>
        <#if item_index==0>
        <thead>
        <tr border-bottom="1">
        <th colspan="3"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_date}<#else/>Date</#if></th>
		<th colspan="4"><span style="nowrap;"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_name}<#else/>Name</#if></span></th>
        <th colspan="9"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_task_note}<#else/>Task/Note</#if></th>
        <th colspan="2" align="right" padding-right="10" ><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_units}<#else/>Units</#if></th>
        <th colspan="2" align="center"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_rate}<#else/>Rate</#if></th>
        <th colspan="3" align="right"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_amount}<#else/>Amount</#if></th>
        </tr>
        </thead>
        </#if>
<#if item.custcol_print_time_entry==true>
		<tr>
        <td colspan="3">${item.custcol_oa_date}</td>
    	<td colspan="4">${item.custcol_oa_wbs_assignees}</td>
        <td colspan="9"><#if item.custcol_oa_wbs_task_name?has_content>${item.custcol_oa_wbs_task_name}: </#if> ${item.description}</td>
        <#setting number_format=",0.00#">
		<td colspan="2" align="right" padding-right="10">${item.custcol_quantity_for_customer}</td>
        <#setting number_format=",##0.00">
        <td colspan="2" align="right">${((item.custcol_unit_price)*(-1))?string(",##0.00;(##0.00)")}</td>
		<#setting number_format=",##0.00">
        <td colspan="3" align="right">${((item.custcol_print_qty*item.custcol_unit_price)*(-1))?string(",##0.00;(##0.00)")}</td>  
        </tr></#if>
  		</#list>
        </table>
  		</#if>

<#-- Print time entries in another table grouped by employees and tasks -->
<#if record.item?has_content && record.custbody_print_time_entry=='T' && record.custbody_expand_service_items!=true && subsidiary.custrecord_expand_service_items_invoice!=true>
		<p font-size="10px"><b>SERVICES</b>
  		</p>
<table border="1" style="width: 100%; margin-top: 10px;">
		<!-- start items -->
        <#list record.item?sort_by("custcol_oa_wbs_task_name","custcol_oa_wbs_assignees") as item>
        <#if item_index==0>
        <thead>
        <tr border-bottom="1">
		<th colspan="4"> <span style="nowrap;"><span style="nowrap;">
          <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_name}<#else/>Name</#if></span></span></th>
        <th colspan="9"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_task_note}<#else/>Task</#if></th>
        <th colspan="2" align="right" padding-right="10" ><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_units}<#else/>Units</#if></th>
        <th colspan="2" align="center" ><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_rate}<#else/>Rate</#if></th>
        <th colspan="2" align="right"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_amount}<#else/>Amount</#if></th>
        </tr>
        </thead>
        </#if>
<#if item.custcol_print_time_entry==true && item.custcol_print_total_hours_bytask_byem?has_content>
		<tr>
    	<td colspan="4">${item.custcol_oa_wbs_assignees}</td>
        <td colspan="9">${item.custcol_oa_wbs_task_name}</td>
		<td colspan="2" align="right" padding-right="10">${item.custcol_print_total_hours_bytask_byem?string.number}</td>
   		<#setting number_format=",##0.00">
        <td colspan="2" align="right">${((item.custcol_unit_price)*(-1))?string(",##0.00;(##0.00)")}</td>
        <#setting number_format=",##0.00">
        <td colspan="2" align="right">${((item.custcol_print_total_hours_bytask_byem*item.custcol_unit_price)*(-1))?string(",##0.00;(##0.00)")}</td>
        </tr></#if>
  		</#list>
        </table>
  		</#if>


<table line-height="150%" style="margin-top:10px;width:100%;">
		<tr>
        <td style="vertical-align: top; width:57%;">
        	
		</td>

		<td align="right" rowspan="4" style="vertical-align: top; width:43%;">
            <table border="1" style="width:100%; margin-right:-5px;" >
            <tr>
              <th align="center" colspan="9" style="border-bottom:1px;"><b>
                <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_total_breakdown}
                <#else/>TOTALS BREAKDOWN</#if></b></th>
            </tr>

            <#if record.subsidiary.custrecord_print_tax_breakdown_summary==true && record.taxtotal!=0>
			<tr>
            <td colspan="9" style="border-top:1px; border-color: #bdc3c7;">   
            	<table style="width:100%; margin-right:-5px;">
                <!-- start items --><#list record.item?sort_by("taxrate1") as item>
                <#if item.custcol_scg_total_tax_by_taxcode?has_content && item.custcol_scg_total_tax_by_taxcode!=0>
                <tr>  
                <td align="right" margin-right="-13"><b>VAT (${item.taxrate1?string.percent})</b></td>  
                <td align="right"> ${((item.custcol_scg_total_tax_by_taxcode)*(-1))?string(",##0.00;(##0.00)")}&nbsp;&nbsp;${record.currency}</td></tr>
                <tr>
                <td align="right" margin-right="-13"><b>Subtotal (${item.taxrate1?string.percent})</b></td>
                <td align="right"> ${((item.custcol_scg_total_amount_by_taxcode)*(-1))?string(",##0.00;(##0.00)")}&nbsp;&nbsp;${record.currency}</td></tr>
                </#if></#list></table>  
            </td></tr>

            <#else/>
            <tr>
            <td align="right" colspan="5"><b><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_subtotal}<#else>Subtotal</#if></b></td>
            <td align="right" colspan="4"><#setting number_format=",##0.00">${((record.subtotal)*(-1))?string(",##0.00;(##0.00)")}&nbsp;&nbsp;${record.currency}</td>
            </tr>
            <tr style="border-top:1px; border-color: #bdc3c7;">
            <td align="right" colspan="5"><b>
              <#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_tax}
              <#elseif record.custbody_gst_hst?has_content>${record.custbody_gst_hst}
              <#elseif subsidiary.country='United States'>Tax
              <#elseif subsidiary.country='Australia'>GST
              <#else>VAT</#if></b></td>
            <td align="right" colspan="4">
              <#if record.custbody_gst_hst='HST' && record.taxtotal !=0> ${((record.taxtotal+record.tax2total)*(-1))?string(",##0.00;(##0.00)")}<#else/>${((record.taxtotal)*(-1))?string(",##0.00;(##0.00)")}</#if>&nbsp;&nbsp;${record.currency}</td>
              </tr></#if>
            <#if record.custbody_gst_hst?has_content>
            <tr style="padding-top:-10px;">
            <td align="right" colspan="5" >Reg. No. ${subsidiary.custrecord_ca_gst_hst_id}</td>
            <td align="right" colspan="4"></td>
            </tr></#if>
            <#if (record.custbody_pst_qst_rst?has_content && record.tax2total?has_content && record.tax2total !=0) || (record.custbody_gst_hst='' && record.tax2total?has_content && record.tax2total !=0)>
            <tr style="border-top:1px; border-color: #bdc3c7;">
            <td align="right" colspan="5"><b>${record.custbody_pst_qst_rst}</b></td>
            <td align="right" colspan="4">${((record.tax2total)*(-1))?string(",##0.00;(##0.00)")}&nbsp;&nbsp;${record.currency}</td>
            </tr>
            <#if record.subsidiary.custrecord_ca_bc_id?has_content && record.shipstate=='BC'>
            <tr style="padding-top:-10px;">
            <td align="right" colspan="5" >Reg. No. ${record.subsidiary.custrecord_ca_bc_id}</td>
            <td align="right" colspan="4"></td>
            </tr></#if>
            <#if record.subsidiary.custrecord_ca_sk_id?has_content && record.shipstate=='SK'>
            <tr style="padding-top:-10px;">
            <td align="right" colspan="5" >Reg. No. ${record.subsidiary.custrecord_ca_sk_id}</td>
            <td align="right" colspan="4" ></td>
            </tr></#if>
            <#if record.subsidiary.custrecord_ca_rst_id?has_content && record.shipstate=='MB'>
            <tr style="padding-top:-10px;">
            <td align="right" colspan="5" >Reg. No. ${record.subsidiary.custrecord_ca_rst_id}</td>
            <td align="right" colspan="4" ></td>
            </tr></#if>
            <#if record.subsidiary.custrecord_ca_qst_id?has_content && record.shipstate=='QC'>
            <tr style="padding-top:-10px;">
            <td align="right" colspan="5" >Reg. No. ${record.subsidiary.custrecord_ca_qst_id}</td>
            <td align="right" colspan="4" ></td>
            </tr></#if>
            </#if>
            <#if record.custbody_reversed_charge==true>
            <tr style="border-top:1px; border-color: #bdc3c7;">
            <td colspan="9" align="center"><b><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_reverse_charge}
              <#else/>REVERSE CHARGE</#if></b></td>
            </tr></#if>
            <tr style="border-top:1px; border-color: #bdc3c7;">
            <td align="right" colspan="5"><b><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_total}<#else/>Total</#if></b></td>
            <td align="right" colspan="4" >${((record.total)*(-1))?string(",##0.00;(##0.00)")}&nbsp;&nbsp;${record.currency}</td>
            </tr>
            </table>
            <#if record.custbody_reversed_charge==true>
              <table  margin-top="20px" style="width:100%;">
              <tr>
              <td>${subsidiary.custrecord_reversed_charge_message} </td>
              </tr>
              </table></#if></td>
          </tr>
          
        </table>
                    
		<table style="width: 100%; margin-top: 10px; margin-bottom: -10px;">
		<tr>
        <td align="center"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_thank_you}!
          <#else/>Thank you for your business!</#if></td>
    	</tr>
  		<#if subsidiary.custrecord_ar_phonenum?has_content || subsidiary.email?has_content>
  		<tr>
    	<td align="center" padding-top="5px" padding-bottom="8px"><#if record.custbody_invoice_label_translation?has_content>${record.custbody_invoice_label_translation.custrecord_inv_label_billing_questions}
          <#else/>Billing Questions</#if>:&nbsp;&nbsp;&nbsp;${subsidiary.custrecord_ar_phonenum} &nbsp;&nbsp;&nbsp;${subsidiary.email}</td>
  		</tr>
        </#if>
        <#if record.shipcountry != subsidiary.country.internalid && record.custbody_in_eu==false && record.subsidiary.custrecord_footer_non_eu?has_content>
  		<tr>
  		<td align="center" padding-top="5px">${subsidiary.custrecord_footer_non_eu}</td>
  		</tr></#if>
        <#if record.shipcountry != subsidiary.country.internalid && record.custbody_in_eu==true && record.subsidiary.custrecord_footer_eu?has_content>
  		<tr>
  		<td align="center" padding-top="5px">${subsidiary.custrecord_footer_eu}</td>
  		</tr></#if> 
  		<#if record.subsidiary.custrecord_invoice_footer1?has_content>
  		<tr>
  		<td align="center" padding-top="5px">${subsidiary.custrecord_invoice_footer1}</td>
  		</tr></#if>
  		<#if record.subsidiary.custrecord_invoice_footer2?has_content>
  		<tr>
  		<td align="center" padding-top="5px">${subsidiary.custrecord_invoice_footer2}</td>
  		</tr></#if>
  		</table>                    


</body>
</pdf>